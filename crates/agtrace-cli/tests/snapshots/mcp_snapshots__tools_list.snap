---
source: crates/agtrace-cli/tests/mcp_snapshots.rs
expression: response
---
{
  "id": 1,
  "jsonrpc": "2.0",
  "result": {
    "tools": [
      {
        "description": "List recent AI agent sessions with cursor-based pagination. WORKFLOW: Call this first to discover available sessions, then use session IDs with other tools. Safe to call multiple times with different filters.",
        "inputSchema": {
          "$defs": {
            "Provider": {
              "description": "Provider type for filtering sessions",
              "oneOf": [
                {
                  "const": "claude_code",
                  "description": "Claude Code (Anthropic)",
                  "type": "string"
                },
                {
                  "const": "codex",
                  "description": "GitHub Copilot Codex",
                  "type": "string"
                },
                {
                  "const": "gemini",
                  "description": "Google Gemini",
                  "type": "string"
                }
              ]
            }
          },
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "description": "List recent AI agent sessions with cursor-based pagination",
          "properties": {
            "cursor": {
              "default": null,
              "description": "Pagination cursor from previous response's next_cursor field. Omit for first page.",
              "type": [
                "string",
                "null"
              ]
            },
            "limit": {
              "default": null,
              "description": "Maximum number of sessions to return (default: 10, max: 50)",
              "format": "uint",
              "minimum": 0,
              "type": [
                "integer",
                "null"
              ]
            },
            "project_hash": {
              "description": "Filter by project hash (internal ID).\nUse only when you have the exact hash; prefer project_root for ergonomic filtering.",
              "type": [
                "string",
                "null"
              ]
            },
            "project_root": {
              "description": "Filter by project root path (e.g., \"/Users/me/projects/my-app\").\nPrefer this over project_hash when the agent knows the current working directory.\nServer will automatically resolve this to the correct project hash.",
              "type": [
                "string",
                "null"
              ]
            },
            "provider": {
              "anyOf": [
                {
                  "$ref": "#/$defs/Provider"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by provider"
            },
            "since": {
              "description": "Show sessions after this timestamp (ISO 8601)",
              "type": [
                "string",
                "null"
              ]
            },
            "until": {
              "description": "Show sessions before this timestamp (ISO 8601)",
              "type": [
                "string",
                "null"
              ]
            }
          },
          "title": "ListSessionsArgs",
          "type": "object"
        },
        "name": "list_sessions"
      },
      {
        "description": "List all projects that have been indexed by agtrace with their metadata. WORKFLOW: Use this to discover available projects and their hashes. Safe to call anytime.",
        "inputSchema": {
          "properties": {},
          "type": "object"
        },
        "name": "get_project_info"
      },
      {
        "description": "Run diagnostic analysis on a session to identify failures, loops, and issues. WORKFLOW: First call list_sessions to obtain session IDs, then use those IDs with this tool. Safe to call in parallel for multiple known session IDs.",
        "inputSchema": {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "description": "Run diagnostic analysis on a session to identify failures, loops, and issues",
          "properties": {
            "include_failures": {
              "default": null,
              "description": "Include failure analysis (default: true)",
              "type": [
                "boolean",
                "null"
              ]
            },
            "include_loops": {
              "default": null,
              "description": "Include loop detection (default: false)",
              "type": [
                "boolean",
                "null"
              ]
            },
            "session_id": {
              "description": "Session ID obtained from list_sessions response (use the 'id' field).\nAccepts 8-character prefix (e.g., \"fb3cff44\") or full UUID.\nREQUIRED: Cannot be empty.",
              "type": "string"
            }
          },
          "required": [
            "session_id"
          ],
          "title": "AnalyzeSessionArgs",
          "type": "object"
        },
        "name": "analyze_session"
      },
      {
        "description": "Search for events and return navigation coordinates (session_id, event_index, turn_index, step_index). Use this to find specific events, then use turn_index with list_turns or get_turns for detailed analysis.",
        "inputSchema": {
          "$defs": {
            "EventType": {
              "description": "Event type for filtering and classification",
              "oneOf": [
                {
                  "const": "ToolCall",
                  "description": "Tool/function call from assistant",
                  "type": "string"
                },
                {
                  "const": "ToolResult",
                  "description": "Tool execution result",
                  "type": "string"
                },
                {
                  "const": "Message",
                  "description": "Assistant message/response",
                  "type": "string"
                },
                {
                  "const": "User",
                  "description": "User input",
                  "type": "string"
                },
                {
                  "const": "Reasoning",
                  "description": "Reasoning/thinking blocks",
                  "type": "string"
                },
                {
                  "const": "TokenUsage",
                  "description": "Token usage statistics",
                  "type": "string"
                },
                {
                  "const": "Notification",
                  "description": "System notification",
                  "type": "string"
                }
              ]
            },
            "Provider": {
              "description": "Provider type for filtering sessions",
              "oneOf": [
                {
                  "const": "claude_code",
                  "description": "Claude Code (Anthropic)",
                  "type": "string"
                },
                {
                  "const": "codex",
                  "description": "GitHub Copilot Codex",
                  "type": "string"
                },
                {
                  "const": "gemini",
                  "description": "Google Gemini",
                  "type": "string"
                }
              ]
            }
          },
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "properties": {
            "cursor": {
              "default": null,
              "type": [
                "string",
                "null"
              ]
            },
            "event_type": {
              "anyOf": [
                {
                  "$ref": "#/$defs/EventType"
                },
                {
                  "type": "null"
                }
              ]
            },
            "limit": {
              "default": null,
              "format": "uint",
              "minimum": 0,
              "type": [
                "integer",
                "null"
              ]
            },
            "project_hash": {
              "type": [
                "string",
                "null"
              ]
            },
            "project_root": {
              "type": [
                "string",
                "null"
              ]
            },
            "provider": {
              "anyOf": [
                {
                  "$ref": "#/$defs/Provider"
                },
                {
                  "type": "null"
                }
              ]
            },
            "query": {
              "type": "string"
            },
            "session_id": {
              "type": [
                "string",
                "null"
              ]
            }
          },
          "required": [
            "query"
          ],
          "title": "SearchEventsArgs",
          "type": "object"
        },
        "name": "search_events"
      },
      {
        "description": "List turns with metadata only (no payload content). Returns turn statistics including step_count, duration_ms, total_tokens, and tools_used. Use this to get an overview before drilling down with get_turns.",
        "inputSchema": {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "properties": {
            "cursor": {
              "default": null,
              "type": [
                "string",
                "null"
              ]
            },
            "limit": {
              "default": null,
              "format": "uint",
              "minimum": 0,
              "type": [
                "integer",
                "null"
              ]
            },
            "session_id": {
              "type": "string"
            }
          },
          "required": [
            "session_id"
          ],
          "title": "ListTurnsArgs",
          "type": "object"
        },
        "name": "list_turns"
      },
      {
        "description": "Get details for specific turns. Defaults are tuned for safety based on data distribution (max 30 steps/turn, 3000 chars/field). WORKFLOW: Fetch 1-2 turns at a time to avoid token limits. If data is marked '[TRUNCATED]' and critical, retry with higher limits.",
        "inputSchema": {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "properties": {
            "max_chars_per_field": {
              "default": null,
              "format": "uint",
              "minimum": 0,
              "type": [
                "integer",
                "null"
              ]
            },
            "max_steps_limit": {
              "default": null,
              "format": "uint",
              "minimum": 0,
              "type": [
                "integer",
                "null"
              ]
            },
            "session_id": {
              "type": "string"
            },
            "truncate": {
              "default": true,
              "type": [
                "boolean",
                "null"
              ]
            },
            "turn_indices": {
              "items": {
                "format": "uint",
                "minimum": 0,
                "type": "integer"
              },
              "type": "array"
            }
          },
          "required": [
            "session_id",
            "turn_indices"
          ],
          "title": "GetTurnsArgs",
          "type": "object"
        },
        "name": "get_turns"
      }
    ]
  }
}
